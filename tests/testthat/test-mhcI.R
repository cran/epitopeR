test_that("test mhcI prediction works", {
  hu <- mhcI(ag_present = c("HLA-A*03:01"),
             ag_stim = c("A_01_01","A_02_06"),
             ag_self = c("B_07_03"),
             method = "rec")

utx <- "MKSCGVSLATAAAAAAAAAFGDEEKKMAAGKASGESEEASPSLTAEEREALGGLDSRLFGFVRFHEDGARMKALLGKAVRCYESLILKAEGKVESDFFCQLGHFNLLLEDYPKALSAYQRYYSLQSDYWKNAAFLYGLGLVYFHYNAFQWAIKAFQEVLYVDPSFCRAKEIHLRLGLMFKVNTDYESSLKHFQLALVDCNPCTLSNAEIQFHIAHLYETQRKYHSAKEAYEQLLQTENLSAQVKATILQQLGWMHHTVDLLGDKATKESYAIQYLQKSLEADPNSGQSWYFLGRCYSSIGKVQDAFISYRQSIDKSEASADTWCSIGVLYQQQNQPMDALQAYICAVQLDHGHAAAWMDLGTLYESCNQPQDAIKCYLNATRSKNCSNTSGLAARIKYLQAQLCNLPQGSLQNKTKLLPSIEEAWSLPIPAELTSRQGAMNTAQQNTSDNWSGGNAPPPVEQQTHSWCLTPQKLQHLEQLRANRNNLNPAQKLMLEQLESQFVLMQQHQMRQTGVAQVRPTGILNGPTVDSSLPTNSVSGQQPQLPLTRMPSVSQPGVHTACPRQTLANGPFSAGHVPCSTSRTLGSTDTVLIGNNHVTGSGSNGNVPYLQRNAPTLPHNRTNLTSSTEEPWKNQLSNSTQGLHKGPSSHLAGPNGERPLSSTGPSQHLQAAGSGIQNQNGHPTLPSNSVTQGAALNHLSSHTATSGGQQGITLTKESKPSGNTLTVPETSRQTGETPNSTASVEGLPNHVHQVMADAVCSPSHGDSKSPGLLSSDNPQLSALLMGKANNNVGPGTCDKVNNIHPTVHTKTDNSVASSPSSAISTATPSPKSTEQTTTNSVTSLNSPHSGLHTINGEGMEESQSPIKTDLLLVSHRPSPQIIPSMSVSIYPSSAEVLKACRNLGKNGLSNSSILLDKCPPPRPPSSPYPPLPKDKLNPPTPSIYLENKRDAFFPPLHQFCTNPNNPVTVIRGLAGALKLDLGLFSTKTLVEANNEHMVEVRTQLLQPADENWDPTGTKKIWHCESNRSHTTIAKYAQYQASSFQESLREENEKRSHHKDHSDSESTSSDNSGKRRKGPFKTIKFGTNIDLSDDKKWKLQLHELTKLPAFVRVVSAGNLLSHVGHTILGMNTVQLYMKVPGSRTPGHQENNNFCSVNINIGPGDCEWFVVPEGYWGVLNDFCEKNNLNFLMGSWWPNLEDLYEANVPVYRFIQRPGDLVWINAGTVHWVQAIGWCNNIAWNVGPLTACQYKLAVERYEWNKLQNVKSIVPMVHLSWNMARNIKVSDPKLFEMIKYCLLRTLKQCQTLREALIAAGKEIIWHGRTKEEPAHYCSICEVEVFDLLFVTNESNSRKTYIVHCQDCARKTSGNLENFVVLEQYKMEDLMQVYDQFTLAPPLPSASS"
uty <- "MKSYGLSLTTAALGNEEKKMAAEKARGEGEEGSFSLTVEEKKALCGLDSSFFGFLTRCKDGAKMKTLLNKAIHFYESLIVKAEGKVESDFFCQLGHFNLLLEDYSKALSSYQRYYSLQTDYWKNAAFLYGLGLVYFYYNAFQWAIRAFQEVLYVDPNFCRAKEIHLRLGFMFKMNTDYESSLKHFQLALIDCNVCTLSSVEIQFHIAHLYETQRKYHSAKAAYEQLLQIESLPSQVKATVLQQLGWMHHNMDLIGDNTTKERYAIQYLQKSLEEDPNSGQSWYFLGRCYSCIGKVQDAFVSYRQSIDKSEASADTWCSIGVLYQQQNQPMDALQAYICAVQLDHGHAAAWMDLGILYESCNQPQDAIKCYLNAARSKSCNNTSALTSRIKFLQAQLCNLPQSSLQNKTKLLPSIEEAWSLPIPAELTSRQGAMNTAQQSVSDTWNSVQTASHHSVQQKVYTQCFTAQKLQSFGKDQQPPFQTGSTRYLQAASTNDQNQNGNHTLPQNSKGDAQNHFLRIPTSEEQKIINFTKESKDSRSKSLTSKTSRKDRDTSNICVNAKKHSNHIYQISSVPISSLNNKESVSPDLIIVDNPQLSVLVGETIDNVDHDIGTCDKVNNVHLAIHKKPDNLSASSPSSAISTETLSLKLTEQTHIVTSFISPHSGLHTINGEGHENLESSASVNVGLRPRSQIIPSMSVSIYSSSTEVLKACRSLGKNGLSNGHILLDICPPPRPPTSPYPPLPKEKLNPPTPSIYLENKRDAFFPPLHQFCINPKNPVTVIRGLAGALKLDLGLFSTKTLVEANNEHIVEVRTQLLQPADENWDPSGTKKIWRYENKSSHTTIAKYAQYQACSFQESLREENERRTQVKDYSDNESTCSDNSGRRQKAPFKTIKCGINIDLSDNKKWKLQLHELTKLPAFVRVVSAGNLLSHVGYTILGMNSVQLCMKVPGSRIPGHQENNNFCSVNINIGPGDCEWFVVPEDYWGVLNDFCEKNNLNFLMSSWWPNLEDLYEANVPVYRFIQRPGDLVWINAGTVHWVQAIGWCNNITWNVGPLTAFQYKLAVERYEWNKLQSVKSVVPMVHLSWNMARNIKVSDPKLFEMIKYCLLKILKHCQTLREALVAAGKEVLWHGRINDEPAPYCSICEVEVFNLLFVTNESNSQKTYIVHCQNCARKTSGNLENFVVLEQYKMEDLIQVYDQFTLAPSLSSAS"

ms <- mhcI(ag_present=c("H-2-Db"),
             seq_len = '9',
             ag_stim = uty,
             ag_self = utx,
             method = "recommended",
             noneself = FALSE)
})
