test_that("test core_mut ", {
  utx <- "MKSCGVSLATAAAAAAAAAFGDEEKKMAAGKASGESEEASPSLTAEEREALGGLDSRLFGFVRFHEDGARMKALLGKAVRCYESLILKAEGKVESDFFCQLGHFNLLLEDYPKALSAYQRYYSLQSDYWKNAAFLYGLGLVYFHYNAFQWAIKAFQEVLYVDPSFCRAKEIHLRLGLMFKVNTDYESSLKHFQLALVDCNPCTLSNAEIQFHIAHLYETQRKYHSAKEAYEQLLQTENLSAQVKATILQQLGWMHHTVDLLGDKATKESYAIQYLQKSLEADPNSGQSWYFLGRCYSSIGKVQDAFISYRQSIDKSEASADTWCSIGVLYQQQNQPMDALQAYICAVQLDHGHAAAWMDLGTLYESCNQPQDAIKCYLNATRSKNCSNTSGLAARIKYLQAQLCNLPQGSLQNKTKLLPSIEEAWSLPIPAELTSRQGAMNTAQQNTSDNWSGGNAPPPVEQQTHSWCLTPQKLQHLEQLRANRNNLNPAQKLMLEQLESQFVLMQQHQMRQTGVAQVRPTGILNGPTVDSSLPTNSVSGQQPQLPLTRMPSVSQPGVHTACPRQTLANGPFSAGHVPCSTSRTLGSTDTVLIGNNHVTGSGSNGNVPYLQRNAPTLPHNRTNLTSSTEEPWKNQLSNSTQGLHKGPSSHLAGPNGERPLSSTGPSQHLQAAGSGIQNQNGHPTLPSNSVTQGAALNHLSSHTATSGGQQGITLTKESKPSGNTLTVPETSRQTGETPNSTASVEGLPNHVHQVMADAVCSPSHGDSKSPGLLSSDNPQLSALLMGKANNNVGPGTCDKVNNIHPTVHTKTDNSVASSPSSAISTATPSPKSTEQTTTNSVTSLNSPHSGLHTINGEGMEESQSPIKTDLLLVSHRPSPQIIPSMSVSIYPSSAEVLKACRNLGKNGLSNSSILLDKCPPPRPPSSPYPPLPKDKLNPPTPSIYLENKRDAFFPPLHQFCTNPNNPVTVIRGLAGALKLDLGLFSTKTLVEANNEHMVEVRTQLLQPADENWDPTGTKKIWHCESNRSHTTIAKYAQYQASSFQESLREENEKRSHHKDHSDSESTSSDNSGKRRKGPFKTIKFGTNIDLSDDKKWKLQLHELTKLPAFVRVVSAGNLLSHVGHTILGMNTVQLYMKVPGSRTPGHQENNNFCSVNINIGPGDCEWFVVPEGYWGVLNDFCEKNNLNFLMGSWWPNLEDLYEANVPVYRFIQRPGDLVWINAGTVHWVQAIGWCNNIAWNVGPLTACQYKLAVERYEWNKLQNVKSIVPMVHLSWNMARNIKVSDPKLFEMIKYCLLRTLKQCQTLREALIAAGKEIIWHGRTKEEPAHYCSICEVEVFDLLFVTNESNSRKTYIVHCQDCARKTSGNLENFVVLEQYKMEDLMQVYDQFTLAPPLPSASS"
  uty <- "MKSYGLSLTTAALGNEEKKMAAEKARGEGEEGSFSLTVEEKKALCGLDSSFFGFLTRCKDGAKMKTLLNKAIHFYESLIVKAEGKVESDFFCQLGHFNLLLEDYSKALSSYQRYYSLQTDYWKNAAFLYGLGLVYFYYNAFQWAIRAFQEVLYVDPNFCRAKEIHLRLGFMFKMNTDYESSLKHFQLALIDCNVCTLSSVEIQFHIAHLYETQRKYHSAKAAYEQLLQIESLPSQVKATVLQQLGWMHHNMDLIGDNTTKERYAIQYLQKSLEEDPNSGQSWYFLGRCYSCIGKVQDAFVSYRQSIDKSEASADTWCSIGVLYQQQNQPMDALQAYICAVQLDHGHAAAWMDLGILYESCNQPQDAIKCYLNAARSKSCNNTSALTSRIKFLQAQLCNLPQSSLQNKTKLLPSIEEAWSLPIPAELTSRQGAMNTAQQSVSDTWNSVQTASHHSVQQKVYTQCFTAQKLQSFGKDQQPPFQTGSTRYLQAASTNDQNQNGNHTLPQNSKGDAQNHFLRIPTSEEQKIINFTKESKDSRSKSLTSKTSRKDRDTSNICVNAKKHSNHIYQISSVPISSLNNKESVSPDLIIVDNPQLSVLVGETIDNVDHDIGTCDKVNNVHLAIHKKPDNLSASSPSSAISTETLSLKLTEQTHIVTSFISPHSGLHTINGEGHENLESSASVNVGLRPRSQIIPSMSVSIYSSSTEVLKACRSLGKNGLSNGHILLDICPPPRPPTSPYPPLPKEKLNPPTPSIYLENKRDAFFPPLHQFCINPKNPVTVIRGLAGALKLDLGLFSTKTLVEANNEHIVEVRTQLLQPADENWDPSGTKKIWRYENKSSHTTIAKYAQYQACSFQESLREENERRTQVKDYSDNESTCSDNSGRRQKAPFKTIKCGINIDLSDNKKWKLQLHELTKLPAFVRVVSAGNLLSHVGYTILGMNSVQLCMKVPGSRIPGHQENNNFCSVNINIGPGDCEWFVVPEDYWGVLNDFCEKNNLNFLMSSWWPNLEDLYEANVPVYRFIQRPGDLVWINAGTVHWVQAIGWCNNITWNVGPLTAFQYKLAVERYEWNKLQSVKSVVPMVHLSWNMARNIKVSDPKLFEMIKYCLLKILKHCQTLREALVAAGKEVLWHGRINDEPAPYCSICEVEVFNLLFVTNESNSQKTYIVHCQNCARKTSGNLENFVVLEQYKMEDLIQVYDQFTLAPSLSSAS"

  re <- mhcII(ag_present = c("H2-IAb"),
              ag_self = utx,
              ag_stim = uty,
              seq_len = c("14"))

  re_core <- core_mut(re, ag_self = utx, ag_stim = uty)
})
